function AddController(e,t,i){function o(e){r.selectedItem={itemName:"",count:""},e&&(r.currentlyEditedItem=null)}function a(){r.currentlyEditedItem.itemName=r.selectedItem.itemName,r.currentlyEditedItem.count=r.selectedItem.count,r.currentlyEditedItem.$update(function(){r.modalDialog.setType("message",r.currentlyEditedItem.itemName+" updated successfully!"),r.modalDialog.showDialog(),o(!0)},function(e){e&&(r.modalDialog.setType("warningMessage","Error updating item: "+e.message),r.modalDialog.showDialog())})}function l(){r.currentlyEditedItem.$delete(function(e){r.modalDialog.setType("message","Item successfully deleted."),r.modalDialog.showDialog();var t=r.existingItems.indexOf(e);r.existingItems.splice(t,1),o(!0)},function(e){e&&(r.modalDialog.setType("warningMessage","Error: "+e.message),r.modalDialog.showDialog()),r.modalDialog.setType("warningMessage","Error"),r.modalDialog.showDialog()})}function s(){var e=new t;e.itemName=r.selectedItem.itemName,e.count=r.selectedItem.count,e.$save(function(e){r.modalDialog.setType("message","Item successfully saved!"),r.modalDialog.showDialog(),r.existingItems.push(e),o()},function(e){e?(r.modalDialog.setType("warningMessage","Error: "+e.message),r.modalDialog().showDialog()):(r.modalDialog.setType("warningMessage","Error"),r.modalDialog.showDialog())})}var r=this;r.modalDialog=e,o(),r.existingItems=t.query(),r.EditMode=function(){return null!=r.currentlyEditedItem},r.ClearSelectionNotAvaliable=function(){return!(r.selectedItem.itemName&&""!=r.selectedItem.itemName||r.selectedItem.count&&""!=r.selectedItem.count)},r.EditItem=function(e){r.currentlyEditedItem=e,r.selectedItem={itemName:e.itemName,count:e.count}},r.SaveEdit=function(){r.modalDialog.setType("update","Do you wish to update "+r.currentlyEditedItem.itemName+" ?"),r.modalDialog.showDialog().then(a)},r.RemoveItem=function(e){r.currentlyEditedItem=e,r.modalDialog.setType("delete","You are about to delete this item. Do you wish to proceed?"),r.modalDialog.showDialog().then(l)},r.SaveNew=function(){e.setType("create","Do want proceeed saving this item?"),e.showDialog().then(s)},r.ClearSelection=function(){o(!0)},r.BackToList=function(){i.go("home")}}function ListController(e,t,i){function o(){l.ItemsToBuy.forEach(function(e){e.checked&&e.$delete(function(){var t=l.ItemsToBuy.indexOf(e);l.ItemsToBuy.splice(t,1)})})}function a(){l.modalDialog.setType("message","Selected item/s were successufuly bought."),l.modalDialog.showDialog()}var l=this;l.modalDialog=e,l.ItemsToBuy=t.query(),l.EditItems=function(){i.go("add")},l.ItemsBought=function(){l.modalDialog.setType("buy","Selected item/s will be removed from the list."),l.modalDialog.showDialog().then(o).then(a)}}function ModalController(){var e=this;e.hide=function(){e.hideDialog()},e.proceed=function(){e.success()}}function errorMessageController(){}function ItemService(e){var t=e("http://localhost:8001/api/items/:id",{id:"@_id"},{update:{method:"PUT"}});return t}function DialogService(e){return{defferedObject:null,visible:!1,showDialog:function(){if(this.visible=!0,this.defferedObject)return this.defferedObject.promise},setType:function(t,i){"message"!==t&&(this.defferedObject=e.defer()),"delete"===t?(this.dialogType="danger",this.title="Danger",this.cancelNeeded=!0,this.body=i,this.btnText="Delete"):"message"===t?(this.dialogType="success",this.title="Success",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"warningMessage"==t?(this.dialogType="warning",this.title="Error",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"create"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Create"):"buy"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Proceed"):"update"===t&&(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Update")},hideDialog:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.reject("return"),this.defferedObject=null)},acceptAndClose:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.resolve("return"),this.defferedObject=null)}}}function ValidateNumberController(){function e(e,t,i,o){o.$validators.validateNumber=function(e){return!isNaN(e)}}return{restrict:"A",require:"ngModel",link:e}}function ValidateStringController(){function e(e){var t=/^[^\/\\%&]*$/,i=e.match(t);return!!i}function t(t,i,o,a){a.$validators.validateString=function(t,i){var o=e(t);return!!o}}return{restrict:"A",require:"ngModel",link:t}}angular.module("shoppingListApp",["shoppingList.services","shoppingList.dialogService","ui.router","shoppingListApp.validators","ngAnimate"]);var app=angular.module("shoppingListApp");app.component("modifyItems",{templateUrl:"static/app/add/add-item.html",controller:["DialogService","ItemsService","$state",AddController]});var app=angular.module("shoppingListApp");app.component("itemList",{templateUrl:"static/app/list/item-list.html",controller:["DialogService","ItemsService","$state",ListController]}),angular.module("shoppingListApp").component("modalView",{templateUrl:"static/app/modal-window/modal-window.html",controller:ModalController,bindings:{title:"<",modalType:"<",btnText:"<",body:"<",hideDialog:"&",success:"&",cancelNeeded:"<"}}),angular.module("shoppingListApp").component("ngErrorMessage",{templateUrl:"static/app/components/error-component/alert-error-component.html",controller:errorMessageController,bindings:{errorText:"@"}}),ItemService.$inject=["$resource"],DialogService.$inject=["$q"],angular.module("shoppingList.services",["ngResource"]).factory("ItemsService",ItemService),angular.module("shoppingList.dialogService",[]).factory("DialogService",DialogService);var app=angular.module("shoppingListApp");app.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("items",{template:"<modal-view></modal-view>",abstract:!0}).state("errorAlert",{template:"<ng-error-message></ng-error-message>",abstract:!0}).state("home",{url:"/",template:"<item-list></item-list>"}).state("add",{url:"/add",template:"<modify-items></modify-items>"})}]),angular.module("shoppingListApp.validators",["shoppingListApp.validators.strings","shoppingListApp.validators.numbers"]),angular.module("shoppingListApp.validators.numbers",[]).directive("validateNumber",ValidateNumberController);var app=angular.module("shoppingListApp.validators.strings",[]);app.directive("validateString",ValidateStringController);