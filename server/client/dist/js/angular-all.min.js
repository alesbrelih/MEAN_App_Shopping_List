!function(e){var t=["shoppingList.services","ui.router","shoppingListApp.validators","ngAnimate"];e.module("shoppingListApp",t)}(window.angular),function(e){function t(e,t,i){function o(e){a.selectedItem={itemName:"",count:""},e&&(a.currentlyEditedItem=null)}function n(){a.currentlyEditedItem.itemName=a.selectedItem.itemName,a.currentlyEditedItem.count=a.selectedItem.count,a.currentlyEditedItem.$update(function(){a.modalDialog.setType("message",a.currentlyEditedItem.itemName+" updated successfully!"),a.modalDialog.showDialog(),o(!0)},function(e){e&&(a.modalDialog.setType("warningMessage","Error updating item: "+e.message),a.modalDialog.showDialog())})}function s(){a.currentlyEditedItem.$delete(function(e){a.modalDialog.setType("message","Item successfully deleted."),a.modalDialog.showDialog();var t=a.existingItems.indexOf(e);a.existingItems.splice(t,1),o(!0)},function(e){e&&(a.modalDialog.setType("warningMessage","Error: "+e.message),a.modalDialog.showDialog()),a.modalDialog.setType("warningMessage","Error"),a.modalDialog.showDialog()})}function r(){var e=new t;e.itemName=a.selectedItem.itemName,e.count=a.selectedItem.count,e.$save(function(e){a.modalDialog.setType("message","Item successfully saved!"),a.modalDialog.showDialog(),a.existingItems.push(e),o()},function(e){e?(a.modalDialog.setType("warningMessage","Error: "+e.message),a.modalDialog().showDialog()):(a.modalDialog.setType("warningMessage","Error"),a.modalDialog.showDialog())})}var a=this;a.modalDialog=e,o(),a.existingItems=t.query(function(e){console.log("sssasasa")},function(e){console.log(e)}),a.EditMode=function(){return null!=a.currentlyEditedItem},a.ClearSelectionNotAvaliable=function(){return!(a.selectedItem.itemName&&""!=a.selectedItem.itemName||a.selectedItem.count&&""!=a.selectedItem.count)},a.EditItem=function(e){a.currentlyEditedItem=e,a.selectedItem={itemName:e.itemName,count:e.count}},a.SaveEdit=function(){a.modalDialog.setType("update","Do you wish to update "+a.currentlyEditedItem.itemName+" ?"),a.modalDialog.showDialog().then(n)},a.RemoveItem=function(e){a.currentlyEditedItem=e,a.modalDialog.setType("delete","You are about to delete this item. Do you wish to proceed?"),a.modalDialog.showDialog().then(s)},a.SaveNew=function(){e.setType("create","Do want proceeed saving this item?"),e.showDialog().then(r)},a.ClearSelection=function(){o(!0)},a.BackToList=function(){i.go("home")}}var i=e.module("shoppingListApp");i.component("modifyItems",{templateUrl:"static/app/add/add-item.html",controller:["DialogService","ItemsService","$state",t]})}(window.angular),function(e){function t(e,t,i,o){function n(){r.ItemsToBuy.forEach(function(e){e.checked&&e.$delete(function(){var t=r.ItemsToBuy.indexOf(e);r.ItemsToBuy.splice(t,1)})})}function s(){r.modalDialog.setType("message","Selected item/s were successufuly bought."),r.modalDialog.showDialog()}var r=this;r.logout=function(){o.LogoutUser()},r.modalDialog=e,r.ItemsToBuy=t.query(),r.EditItems=function(){i.go("add")},r.ItemsBought=function(){r.modalDialog.setType("buy","Selected item/s will be removed from the list."),r.modalDialog.showDialog().then(n).then(s)}}var i=e.module("shoppingListApp");i.component("itemList",{templateUrl:"static/app/list/item-list.html",controller:["DialogService","ItemsService","$state","AuthService",t]})}(window.angular),function(e){function t(e,t,i){t.$on("unauthorized",function(){i.LogoutUser(),e.go("auth.login")})}t.$inject=["$state","$rootScope","AuthService"],e.module("shoppingListApp").controller("MainCtrl",t)}(window.angular),function(e){function t(){var e=this;e.hide=function(){e.hideDialog()},e.proceed=function(){e.success()}}e.module("shoppingListApp").component("modalView",{templateUrl:"static/app/modal-window/modal-window.html",controller:t,bindings:{title:"<",modalType:"<",btnText:"<",body:"<",hideDialog:"&",success:"&",cancelNeeded:"<"}})}(window.angular);var app=angular.module("shoppingListApp");app.component("userAuth",{templateUrl:"static/app/user/user-layout.html"}),function(e){function t(){}e.module("shoppingListApp").component("ngErrorMessage",{templateUrl:"static/app/components/error-component/alert-error-component.html",controller:t,bindings:{errorText:"@"}})}(window.angular),function(e){e.module("shoppingList.services",["shoppingList.services.dialogService","shoppingList.services.itemservice","shoppingList.services.authentication","shoppingList.services.httpinterceptor"])}(window.angular),function(e){function t(e,t,i){i.$on("$stateChangeStart",function(i,o,n,s,r,a){o.name.startsWith("auth")||t.IsLoggedIn()||(i.preventDefault(),e.go("auth.login"))})}var i=e.module("shoppingListApp");i.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("items",{template:"<modal-view></modal-view>",abstract:!0}).state("errorAlert",{template:"<ng-error-message></ng-error-message>",abstract:!0}).state("home",{url:"/",template:"<item-list></item-list>"}).state("add",{url:"/add",template:"<modify-items></modify-items>"}).state("auth",{url:"/auth",template:"<user-auth></user-auth>"}).state("auth.register",{url:"/register",template:"<user-register></user-register>"}).state("auth.login",{url:"/login",template:"<user-login></user-login>"})}]),i.config(["$httpProvider",function(e){e.interceptors.push("HttpIntercept")}]),i.run(t),t.$inject=["$state","JwtService","$rootScope"]}(window.angular),function(e){e.module("shoppingListApp.validators",["shoppingListApp.validators.strings","shoppingListApp.validators.numbers","shoppingListApp.validators.passwordMatch"])}(window.angular),function(e){function t(){function e(e,t,i,o){o.$validators.validateNumber=function(e){return!isNaN(e)}}return{restrict:"A",require:"ngModel",link:e}}e.module("shoppingListApp.validators.numbers",[]).directive("validateNumber",t)}(window.angular),function(e){function t(){function e(e,t,i,o){o.$validators.passwordMatch=function(t){return e.firstPwdValue===t},e.$watch("firstPwdValue",function(){o.$validate()})}return{restrict:"A",require:"ngModel",scope:{firstPwdValue:"<abPwdMatch"},link:e}}e.module("shoppingListApp.validators.passwordMatch",[]).directive("abPwdMatch",t)}(window.angular),function(e){function t(){function e(e){var t=/^[^\/\\%&]*$/,i=e.match(t);return!!i}function t(t,i,o,n){n.$validators.validateString=function(t){var i=e(t);return!!i}}return{restrict:"A",require:"ngModel",link:t}}var i=e.module("shoppingListApp.validators.strings",[]);i.directive("validateString",t)}(window.angular),function(e){function t(e,t){var i=this;i.user={email:"",password:""},i.login=function(){e.LoginUser(i.user)}}t.$inject=["AuthService","$state"];var i=e.module("shoppingListApp");i.component("userLogin",{templateUrl:"static/app/user/login/login-user.html",controller:t})}(window.angular),function(e){function t(e){var t=this;t.user={email:"",password:""},t.register=function(){e.RegisterUser(t.user)}}t.$inject=["AuthService"];var i=e.module("shoppingListApp");i.component("userRegister",{templateUrl:"static/app/user/register/register-user.html",controller:t})}(window.angular),function(e){function t(e,t,i){function o(i){e.post("http://localhost:8001/api/user/register",i).then(function(e){var i=e.data.token;t.SaveToken(i)},function(e){console.log(e)})}function n(o){return e.post("http://localhost:8001/api/user/login",o).then(function(e){var o=e.data.token;t.SaveToken(o),i.go("home")},function(e){console.warn(e)})}function s(){t.RemoveToken()}return{RegisterUser:o,LoginUser:n,LogoutUser:s,IsLoggedIn:t.IsLoggedIn()}}t.$inject=["$http","JwtService","$state"],e.module("shoppingList.services.authentication",["shoppingList.services.jwt"]).factory("AuthService",t)}(window.angular),function(e){function t(e){return{defferedObject:null,visible:!1,showDialog:function(){if(this.visible=!0,this.defferedObject)return this.defferedObject.promise},setType:function(t,i){"message"!==t&&(this.defferedObject=e.defer()),"delete"===t?(this.dialogType="danger",this.title="Danger",this.cancelNeeded=!0,this.body=i,this.btnText="Delete"):"message"===t?(this.dialogType="success",this.title="Success",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"warningMessage"==t?(this.dialogType="warning",this.title="Error",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"create"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Create"):"buy"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Proceed"):"update"===t&&(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Update")},hideDialog:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.reject("return"),this.defferedObject=null)},acceptAndClose:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.resolve("return"),this.defferedObject=null)}}}t.$inject=["$q"],e.module("shoppingList.services.dialogService",[]).factory("DialogService",t)}(window.angular),function(e){function t(e,t,i){return{request:function(e){return t.IsLoggedIn()&&(e.headers.token=t.GetToken()),e},responseError:function(t){return 401===t.status&&i.$broadcast("unauthorized"),e.reject(t)}}}t.$inject=["$q","JwtService","$rootScope"],e.module("shoppingList.services.httpinterceptor",[]).factory("HttpIntercept",t)}(window.angular),function(e){function t(e){var t=e("http://localhost:8001/api/items/:id",{id:"@_id"},{update:{method:"PUT"}});return t}t.$inject=["$resource"],e.module("shoppingList.services.itemservice",["ngResource"]).factory("ItemsService",t)}(window.angular),function(e){function t(e){function t(){return!!e.localStorage.getItem(s)}function i(){var t=e.localStorage.getItem(s);return t}function o(){e.localStorage.getItem(s)&&e.localStorage.removeItem(s)}function n(t){e.localStorage.setItem(s,t)}var s="jwt";return{GetToken:i,IsLoggedIn:t,RemoveToken:o,SaveToken:n}}t.$inject=["$window"],e.module("shoppingList.services.jwt",[]).factory("JwtService",t)}(window.angular);