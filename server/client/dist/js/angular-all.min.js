!function(e){var t=["shoppingList.services","ui.router","shoppingListApp.validators","ngAnimate","abToaster.component"];e.module("shoppingListApp",t)}(window.angular),function(e){function t(e,t,i,o){function n(e){c.selectedItem={itemName:"",count:""},e&&(c.currentlyEditedItem=null)}function r(){c.currentlyEditedItem.itemName=c.selectedItem.itemName,c.currentlyEditedItem.count=c.selectedItem.count,c.currentlyEditedItem.$update(function(){o.Add("alert","Item updated successfully!"),n(!0)},function(e){e&&o.Add("warning","Error updating item!")})}function s(){c.currentlyEditedItem.$delete(function(e){o.Add("warning","Item successfully deleted.");var t=c.existingItems.indexOf(e);c.existingItems.splice(t,1),n(!0)},function(e){e&&o.Add("warning","Error: "+e.message),o.Add("warning","Error!")})}function a(){var e=new t;e.itemName=c.selectedItem.itemName,e.count=c.selectedItem.count,e.$save(function(e){o.Add("success","Item successfully saved."),c.existingItems.push(e),n()},function(e){e?o.Add("warning","Error: "+e.message):o.Add("warning","Error!")})}var c=this;c.modalDialog=e,n(),c.existingItems=t.query(),c.EditMode=function(){return null!=c.currentlyEditedItem},c.ClearSelectionNotAvaliable=function(){return!(c.selectedItem.itemName&&""!=c.selectedItem.itemName||c.selectedItem.count&&""!=c.selectedItem.count)},c.EditItem=function(e){c.currentlyEditedItem=e,c.selectedItem={itemName:e.itemName,count:e.count}},c.SaveEdit=function(){c.modalDialog.setType("update","Do you wish to update "+c.currentlyEditedItem.itemName+" ?"),c.modalDialog.showDialog().then(r)},c.RemoveItem=function(e){c.currentlyEditedItem=e,c.modalDialog.setType("delete","You are about to delete this item. Do you wish to proceed?"),c.modalDialog.showDialog().then(s)},c.SaveNew=function(){e.setType("create","Do want proceeed saving this item?"),e.showDialog().then(a)},c.ClearSelection=function(){n(!0)},c.BackToList=function(){i.go("home")}}var i=e.module("shoppingListApp");i.component("modifyItems",{templateUrl:"static/app/add/add-item.html",controller:["DialogService","ItemsService","$state","ToasterService",t]})}(window.angular),function(e){function t(e,t,i){var o=this;e.GetProfileInfo(),o.profileName=e.ProfileName,i.$on("login",function(){e.GetProfileInfo()}),i.$on("register",function(){e.GetProfileInfo()}),i.$on("logout",function(){o.profileName.display=""}),o.logout=function(){e.LogoutUser()}}t.$inject=["AuthService","$state","$rootScope"];var i=e.module("shoppingListApp");i.component("abSlHeader",{templateUrl:"static/app/header/header-component-template.html",controller:t})}(window.angular),function(e){function t(e,t,i,o,n){function r(){a.ItemsToBuy.forEach(function(e){e.checked&&e.$delete(function(){var t=a.ItemsToBuy.indexOf(e);a.ItemsToBuy.splice(t,1)})})}function s(){n.Add("success","Item was successfully bought.")}var a=this;a.modalDialog=e,a.ItemsToBuy=t.query(),a.EditItems=function(){i.go("add")},a.ItemsBought=function(){a.modalDialog.setType("buy","Selected item/s will be removed from the list."),a.modalDialog.showDialog().then(r).then(s)}}var i=e.module("shoppingListApp");i.component("itemList",{templateUrl:"static/app/list/item-list.html",controller:["DialogService","ItemsService","$state","AuthService","ToasterService",t]})}(window.angular),function(e){function t(e,t,i){t.$on("unauthorized",function(){i.LogoutUser(),e.go("auth.login")})}t.$inject=["$state","$rootScope","AuthService"],e.module("shoppingListApp").controller("MainCtrl",t)}(window.angular),function(e){function t(){var e=this;e.hide=function(){e.hideDialog()},e.proceed=function(){e.success()}}e.module("shoppingListApp").component("modalView",{templateUrl:"static/app/modal-window/modal-window.html",controller:t,bindings:{title:"<",modalType:"<",btnText:"<",body:"<",hideDialog:"&",success:"&",cancelNeeded:"<"}})}(window.angular);var app=angular.module("shoppingListApp");app.component("userAuth",{templateUrl:"static/app/user/user-layout.html"}),function(e){function t(){}e.module("shoppingListApp").component("ngErrorMessage",{templateUrl:"static/app/components/error-component/alert-error-component.html",controller:t,bindings:{errorText:"@"}})}(window.angular),function(e){e.module("shoppingList.services",["shoppingList.services.dialogService","shoppingList.services.itemservice","shoppingList.services.authentication","shoppingList.services.httpinterceptor","toasterServiceModule"])}(window.angular),function(e){function t(e,t,i){i.$on("$stateChangeStart",function(i,o,n,r,s,a){o.name.startsWith("auth")||t.IsLoggedIn()||(i.preventDefault(),e.go("auth.login"))})}var i=e.module("shoppingListApp");i.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("items",{template:"<modal-view></modal-view>",abstract:!0}).state("errorAlert",{template:"<ng-error-message></ng-error-message>",abstract:!0}).state("home",{url:"/",template:"<item-list></item-list>"}).state("add",{url:"/add",template:"<modify-items></modify-items>"}).state("auth",{url:"/auth",template:"<user-auth></user-auth>"}).state("auth.register",{url:"/register",template:"<user-register></user-register>"}).state("auth.login",{url:"/login",template:"<user-login></user-login>"})}]),i.config(["$httpProvider",function(e){e.interceptors.push("HttpIntercept")}]),i.run(t),t.$inject=["$state","JwtService","$rootScope"]}(window.angular),function(e){e.module("shoppingListApp.validators",["shoppingListApp.validators.strings","shoppingListApp.validators.numbers","shoppingListApp.validators.passwordMatch"])}(window.angular),function(e){function t(){function e(e,t,i,o){o.$validators.validateNumber=function(e){return!isNaN(e)}}return{restrict:"A",require:"ngModel",link:e}}e.module("shoppingListApp.validators.numbers",[]).directive("validateNumber",t)}(window.angular),function(e){function t(){function e(e,t,i,o){o.$validators.passwordMatch=function(t){return e.firstPwdValue===t},e.$watch("firstPwdValue",function(){o.$validate()})}return{restrict:"A",require:"ngModel",scope:{firstPwdValue:"<abPwdMatch"},link:e}}e.module("shoppingListApp.validators.passwordMatch",[]).directive("abPwdMatch",t)}(window.angular),function(e){function t(){function e(e){var t=/^[^\/\\%&]*$/,i=e.match(t);return!!i}function t(t,i,o,n){n.$validators.validateString=function(t){var i=e(t);return!!i}}return{restrict:"A",require:"ngModel",link:t}}var i=e.module("shoppingListApp.validators.strings",[]);i.directive("validateString",t)}(window.angular),function(e){function t(e){var t=this;t.Toasters=e.Toasters}t.$inject=["ToasterService"];var i=e.module("abToaster.component",["abToaster.msg"]);i.component("abToasters",{templateUrl:"static/app/components/toaster-component/toaster-component.html",controller:t})}(window.angular),function(e){function t(e){var t=this;t.user={email:"",password:""},t.login=function(){e.LoginUser(t.user)}}t.$inject=["AuthService"];var i=e.module("shoppingListApp");i.component("userLogin",{templateUrl:"static/app/user/login/login-user.html",controller:t})}(window.angular),function(e){function t(e){var t=this;t.user={email:"",password:""},t.register=function(){e.RegisterUser(t.user)}}t.$inject=["AuthService"];var i=e.module("shoppingListApp");i.component("userRegister",{templateUrl:"static/app/user/register/register-user.html",controller:t})}(window.angular),function(e){function t(e,t,i,o,n){function r(r){e.post("http://localhost:8001/api/user/register",r).then(function(e){var r=e.data.token;t.SaveToken(r),o.Add("success","Account successfully created."),n.$broadcast("register"),i.go("home")},function(e){11e3==e.data.code?o.Add("warning","User with this email alredy exists!"):o.Add("warning","Error registering user!")})}function s(r){return e.post("http://localhost:8001/api/user/login",r).then(function(e){var r=e.data.token;t.SaveToken(r),o.Add("success","Login successfull."),n.$broadcast("login"),i.go("home")},function(e){o.Add("warning","Error logging in: "+e.data.message)})}function a(){t.RemoveToken(),n.$broadcast("logout"),i.go("auth.login"),o.Add("alert","Logged out.")}function c(){e.post("http://localhost:8001/api/user/profile").then(function(e){var t=e.data;t.name?l.display=t.name:l.display=t.email})}var l={display:""};return{RegisterUser:r,LoginUser:s,LogoutUser:a,IsLoggedIn:t.IsLoggedIn(),GetProfileInfo:c,ProfileName:l}}t.$inject=["$http","JwtService","$state","ToasterService","$rootScope"],e.module("shoppingList.services.authentication",["shoppingList.services.jwt"]).factory("AuthService",t)}(window.angular),function(e){function t(e){return{defferedObject:null,visible:!1,showDialog:function(){if(this.visible=!0,this.defferedObject)return this.defferedObject.promise},setType:function(t,i){"message"!==t&&(this.defferedObject=e.defer()),"delete"===t?(this.dialogType="danger",this.title="Danger",this.cancelNeeded=!0,this.body=i,this.btnText="Delete"):"message"===t?(this.dialogType="success",this.title="Success",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"warningMessage"==t?(this.dialogType="warning",this.title="Error",this.cancelNeeded=!1,this.body=i,this.btnText="Proceed"):"create"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Create"):"buy"===t?(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Proceed"):"update"===t&&(this.dialogType="alert",this.title="Alert",this.cancelNeeded=!0,this.body=i,this.btnText="Update")},hideDialog:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.reject("return"),this.defferedObject=null)},acceptAndClose:function(){this.visible=!1,this.defferedObject&&(this.defferedObject.resolve("return"),this.defferedObject=null)}}}t.$inject=["$q"],e.module("shoppingList.services.dialogService",[]).factory("DialogService",t)}(window.angular),function(e){function t(e,t,i,o){return{request:function(e){return t.IsLoggedIn()&&(e.headers.token=t.GetToken()),e},responseError:function(t){return 401===t.status&&(i.$broadcast("unauthorized"),i.$broadcast("logout"),o.Add("alert","Please login.")),e.reject(t)}}}t.$inject=["$q","JwtService","$rootScope","ToasterService"],e.module("shoppingList.services.httpinterceptor",[]).factory("HttpIntercept",t)}(window.angular),function(e){function t(e){var t=e("http://localhost:8001/api/items/:id",{id:"@_id"},{update:{method:"PUT"}});return t}t.$inject=["$resource"],e.module("shoppingList.services.itemservice",["ngResource"]).factory("ItemsService",t)}(window.angular),function(e){function t(e){var t=0,i=[],o=function(o,r){var s=++t;i.push({index:s,type:o,message:r,visible:!1}),e(function(){n(s)},2e3)},n=function(e){var t=i.filter(function(t){return t.index==e});if(t.length>0){t=t[0];var o=i.indexOf(t);i.splice(o,1)}};return{Toasters:i,Add:o,Remove:n}}t.$inject=["$timeout"];var i=e.module("toasterServiceModule",[]);i.factory("ToasterService",t)}(window.angular),function(e){function t(e){function t(){return!!e.localStorage.getItem(r)}function i(){var t=e.localStorage.getItem(r);return t}function o(){e.localStorage.getItem(r)&&e.localStorage.removeItem(r)}function n(t){e.localStorage.setItem(r,t)}var r="jwt";return{GetToken:i,IsLoggedIn:t,RemoveToken:o,SaveToken:n}}t.$inject=["$window"],e.module("shoppingList.services.jwt",[]).factory("JwtService",t)}(window.angular),function(e){function t(e){var t=this;t.removeToaster=function(t){e.Remove(t)}}t.$inject=["ToasterService"];var i=e.module("abToaster.msg",[]);i.component("abToastMsg",{bindings:{toastCfg:"<"},templateUrl:"static/app/components/toaster-component/toaster-msg-component/toaster-msg-component.html",controller:t})}(window.angular);